
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>HTTP Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="time.html" />
    
    
    <link rel="prev" href="random.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../get_started.html">
            
                <a href="../../get_started.html">
            
                    
                    Get Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../core_language.html">
            
                <a href="../../core_language.html">
            
                    
                    Core Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../">
            
                <a href="../">
            
                    
                    The Elm Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../user_input/">
            
                <a href="../user_input/">
            
                    
                    User Input
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../user_input/buttons.html">
            
                <a href="../user_input/buttons.html">
            
                    
                    Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../user_input/text_fields.html">
            
                <a href="../user_input/text_fields.html">
            
                    
                    Text Fields
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../user_input/forms.html">
            
                <a href="../user_input/forms.html">
            
                    
                    Forms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../user_input/more.html">
            
                <a href="../user_input/more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="./">
            
                <a href="./">
            
                    
                    Effects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="random.html">
            
                <a href="random.html">
            
                    
                    Random
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.2.2" data-path="http.html">
            
                <a href="http.html">
            
                    
                    HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="time.html">
            
                <a href="time.html">
            
                    
                    Time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="web_sockets.html">
            
                <a href="web_sockets.html">
            
                    
                    Web Sockets
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../more.html">
            
                <a href="../more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../types/">
            
                <a href="../../types/">
            
                    
                    Types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../types/reading_types.html">
            
                <a href="../../types/reading_types.html">
            
                    
                    Reading Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../types/type_aliases.html">
            
                <a href="../../types/type_aliases.html">
            
                    
                    Type Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../types/union_types.html">
            
                <a href="../../types/union_types.html">
            
                    
                    Union Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../error_handling/">
            
                <a href="../../error_handling/">
            
                    
                    Error Handling and Tasks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../error_handling/maybe.html">
            
                <a href="../../error_handling/maybe.html">
            
                    
                    Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../error_handling/result.html">
            
                <a href="../../error_handling/result.html">
            
                    
                    Result
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../error_handling/task.html">
            
                <a href="../../error_handling/task.html">
            
                    
                    Task
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../interop/">
            
                <a href="../../interop/">
            
                    
                    Interop
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../interop/json.html">
            
                <a href="../../interop/json.html">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../interop/javascript.html">
            
                <a href="../../interop/javascript.html">
            
                    
                    JavaScript
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../reuse/">
            
                <a href="../../reuse/">
            
                    
                    Scaling The Elm Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../reuse/checkboxes.html">
            
                <a href="../../reuse/checkboxes.html">
            
                    
                    Labeled Checkboxes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../reuse/radio_buttons.html">
            
                <a href="../../reuse/radio_buttons.html">
            
                    
                    Radio Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../reuse/modules.html">
            
                <a href="../../reuse/modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../reuse/more.html">
            
                <a href="../../reuse/more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../effect_managers/">
            
                <a href="../../effect_managers/">
            
                    
                    Effect Managers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../effect_managers/caching.html">
            
                <a href="../../effect_managers/caching.html">
            
                    
                    Caching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../effect_managers/batching.html">
            
                <a href="../../effect_managers/batching.html">
            
                    
                    Batching
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >HTTP</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="http">HTTP</h1>
<hr>
<h4 id="clone-the-code-or-follow-along-in-the-online-editor"><a href="https://github.com/evancz/elm-architecture-tutorial/" target="_blank">Clone the code</a> or follow along in the <a href="http://elm-lang.org/examples/http" target="_blank">online editor</a>.</h4>
<hr>
<p>We are about to make an app that fetches a random GIF when the user asks for another image.</p>
<p>Now, I am going to assume you just read the randomness example. It (1) introduces a two step process for writing apps like this and (2) shows the simplest kind of commands possible. Here we will be using the same two step process to build up to fancier kinds of commands, so I very highly recommend going back one page. I swear you will reach your goals faster if you start with a solid foundation!</p>
<p>...</p>
<p>Okay, so you read it now right? Good. Let&apos;s get started on our random gif fetcher!</p>
<h2 id="phase-one---the-bare-minimum">Phase One - The Bare Minimum</h2>
<p>At this point in this guide, you should be pretty comfortable smacking down the basic skeleton of an Elm app. Guess at the model, fill in some messages, etc. etc.</p>
<pre><code class="lang-elm"><span class="hljs-comment">-- MODEL</span>

<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Model</span> =
  { topic : <span class="hljs-type">String</span>
  , gifUrl : <span class="hljs-type">String</span>
  }

<span class="hljs-title">init</span> : (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">init</span> =
  (<span class="hljs-type">Model</span> <span class="hljs-string">&quot;cats&quot;</span> <span class="hljs-string">&quot;waiting.gif&quot;</span>, <span class="hljs-type">Cmd</span>.none)


<span class="hljs-comment">-- UPDATE</span>

<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span> = <span class="hljs-type">MorePlease</span>

<span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">update</span> msg model =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
    <span class="hljs-type">MorePlease</span> -&gt;
      (model, <span class="hljs-type">Cmd</span>.none)


<span class="hljs-comment">-- VIEW</span>

<span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> model =
  div []
    [ h2 [] [text model.topic]
    , img [src model.gifUrl] []
    , button [ onClick <span class="hljs-type">MorePlease</span> ] [ text <span class="hljs-string">&quot;More Please!&quot;</span> ]
    ]
</code></pre>
<p>For the model, I decided to track a <code>topic</code> so I know what kind of gifs to fetch. I do not want to hard code it to <code>&quot;cats&quot;</code>, and maybe later we will want to let the user decide the topic too. I also tracked the <code>gifUrl</code> which is a URL that points at some random gif.</p>
<p>Like in the randomness example, I just made dummy <code>init</code> and <code>update</code> functions. None of them actually produce any commands for now. The point is just to get something on screen!</p>
<h2 id="phase-two---adding-the-cool-stuff">Phase Two - Adding the Cool Stuff</h2>
<p>Alright, the obvious thing missing right now is the HTTP request. I think it is easiest to start this process by adding new kinds of messages. Now remember, <strong>when you give a command, you have to wait for it to happen.</strong> So when we command Elm to do an HTTP request, it is eventually going to tell you &quot;hey, here is what you wanted&quot; or it is going to say &quot;oops, something went wrong with the HTTP request&quot;. We need this to be reflected in our messages:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
  = <span class="hljs-type">MorePlease</span>
  | <span class="hljs-type">FetchSucceed</span> <span class="hljs-type">String</span>
  | <span class="hljs-type">FetchFail</span> <span class="hljs-type">Http</span>.<span class="hljs-type">Error</span>
</code></pre>
<p>We still have <code>MorePlease</code> from before, but for the HTTP results, we add <code>FetchSucceed</code> that holds the new gif URL and <code>FetchFail</code> that indicates there was some HTTP issue (server is down, bad URL, etc.)</p>
<p>That is enough to start filling in <code>update</code>:</p>
<pre><code class="lang-elm"><span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">update</span> msg model =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
    <span class="hljs-type">MorePlease</span> -&gt;
      (model, getRandomGif model.topic)

    <span class="hljs-type">FetchSucceed</span> newUrl -&gt;
      (<span class="hljs-type">Model</span> model.topic newUrl, <span class="hljs-type">Cmd</span>.none)

    <span class="hljs-type">FetchFail</span> _ -&gt;
      (model, <span class="hljs-type">Cmd</span>.none)
</code></pre>
<p>So I added branches for our new messages. In the case of <code>FetchSucceed</code> we update the <code>gifUrl</code> field to have the new URL. In the case of <code>FetchFail</code> we pretty much ignore it, giving back the same model and doing nothing.</p>
<p>I also changed the <code>MorePlease</code> branch a bit. We need an HTTP command, so I called the <code>getRandomGif</code> function. The trick is that I made that function up. It does not exist yet. That is the next step!</p>
<p>Defining <code>getRandomGif</code> might look something like this:</p>
<pre><code class="lang-elm"><span class="hljs-title">getRandomGif</span> : <span class="hljs-type">String</span> -&gt; <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">getRandomGif</span> topic =
  <span class="hljs-keyword">let</span>
    url =
      <span class="hljs-string">&quot;https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&amp;tag=&quot;</span> ++ topic
  <span class="hljs-keyword">in</span>
    <span class="hljs-type">Task</span>.perform <span class="hljs-type">FetchFail</span> <span class="hljs-type">FetchSucceed</span> (<span class="hljs-type">Http</span>.get decodeGifUrl url)

<span class="hljs-title">decodeGifUrl</span> : <span class="hljs-type">Json</span>.<span class="hljs-type">Decoder</span> <span class="hljs-type">String</span>
<span class="hljs-title">decodeGifUrl</span> =
  <span class="hljs-type">Json</span>.at [<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;image_url&quot;</span>] <span class="hljs-type">Json</span>.string
</code></pre>
<p>Okay, so the <code>getRandomGif</code> function is not exceptionally crazy. We first define the <code>url</code> we need to hit to get random gifs. Next we have <a href="http://package.elm-lang.org/packages/evancz/elm-http/3.0.1/Http#get" target="_blank">this <code>Http.get</code> function</a> which is going to GET some JSON from the <code>url</code> we give it. The interesting part there is The <code>decodeGifUrl</code> argument which describes how to turn JSON into Elm values. In our case, we are saying &#x201C;try to get the value at <code>json.data.image_url</code> and it should be a string.&#x201D;</p>
<blockquote>
<p><strong>Note:</strong> See <a href="http://guide.elm-lang.org/interop/json.html" target="_blank">this</a> for more information on JSON decoders. It will clarify how it works, but for now, you really just need a high-level understanding. It turns JSON into Elm.</p>
</blockquote>
<p>The <code>Task.perform</code> part is clarifying what to do with the result of this GET:</p>
<ol>
<li>The first argument <code>FetchFail</code> is for when the GET fails. If the server is down or the URL is a 404, we tag the resulting error with <code>FetchFail</code> and feed it into our <code>update</code> function.</li>
<li>The second argument <code>FetchSucceed</code> is for when the GET succeeds. When we get some URL back like <code>http://example.com/json</code>, we convert it into  <code>FetchSucceed &quot;http://example.com/json&quot;</code> so that it can be fed into our <code>update</code> function.</li>
</ol>
<p>We will get into the details of how this all works later in this guide, but for now, if you just follow the pattern here, you will be fine using HTTP.</p>
<p>And now when you click the &quot;More&quot; button, it actually goes and fetches a random gif!</p>
<blockquote>
<p><strong>Exercises:</strong> To get more comfortable with this code, try augmenting it with skills we learned in previous sections:</p>
<ul>
<li>Show a message explaining why the image didn&apos;t change when you get a <code>FetchFail</code>.</li>
<li>Allow the user to modify the <code>topic</code> with a text field.</li>
<li>Allow the user to modify the <code>topic</code> with a drop down menu.</li>
</ul>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="random.html" class="navigation navigation-prev " aria-label="Previous page: Random">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="time.html" class="navigation navigation-next " aria-label="Next page: Time">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"HTTP","level":"1.4.2.2","depth":3,"next":{"title":"Time","level":"1.4.2.3","depth":3,"path":"architecture/effects/time.md","ref":"architecture/effects/time.md","articles":[]},"previous":{"title":"Random","level":"1.4.2.1","depth":3,"path":"architecture/effects/random.md","ref":"architecture/effects/random.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ga","youtube"],"pluginsConfig":{"ga":{"configuration":"auto","token":"UA-25827182-1"},"youtube":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"architecture/effects/http.md","mtime":"2016-11-03T07:08:22.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-11-03T07:10:54.632Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

